<th:block xmlns:th="http://www.w3.org/1999/xhtml" th:fragment="statisticsPine">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <div class="tab-pane fade show active container-fluid" id="pineStats">
        <br>
        <table style="width: 100%" >
            <tr>
                <th scope="col">Описание</th>
                <th scope="col">Толщина, мм</th>
                <th scope="col">Ширина, мм</th>
                <th scope="col">Длина, мм</th>
                <th scope="col">Производитель</th>
                <th scope="col">Стадия</th>
            </tr>
            <tr style="vertical-align: top;">
                <td style="width: 15%">
                    <select id="selectDescription" class="form-control form-control-chosen" data-placeholder="Выберите нужные..." multiple="multiple">
                        <option  th:each="obj : ${descList}" th:value="${obj}" th:text="${obj}"></option>
                    </select>
                </td>
                <td style="width: 15%">
                    <select id="selectSizeOfHeight" class="form-control form-control-chosen" data-placeholder="Выберите нужные..." multiple="multiple">
                        <option  th:each="obj : ${sizeOfHeightList}" th:value="${obj}" th:text="${obj}"></option>
                    </select>
                </td>
                <td style="width: 15%">
                    <select id="selectSizeOfWidth" class="form-control form-control-chosen" data-placeholder="Выберите нужные..." multiple="multiple">
                        <option  th:each="obj : ${sizeOfWidthList}" th:value="${obj}" th:text="${obj}"></option>
                    </select>
                </td>
                <td style="width: 15%">
                    <select id="selectSizeOfLong" class="form-control form-control-chosen" data-placeholder="Выберите нужные..." multiple="multiple">
                        <option  th:each="obj : ${sizeOfLongList}" th:value="${obj}" th:text="${obj}"></option>
                    </select>
                </td>
                <td style="width: 20%">
                    <select id="selectProvider" class="form-control form-control-chosen" data-placeholder="Выберите нужные..." multiple="multiple">
                        <option  th:each="obj : ${providerList}" th:value="${obj.id}" th:text="${obj.nameOfAgent}"></option>
                    </select>
                </td>
                <td style="width: 20%">
                    <select id="selectStage" class="form-control form-control-chosen" data-placeholder="Выберите нужные..." multiple="multiple">
                        <option  value="treeStorage">Кругляк</option>
                        <option  value="rawStorage">Сырой склад</option>
                        <option  value="dryingStorage">Сушка</option>
                        <option  value="dryStorage">Сухой склад</option>
                        <option  value="packagedProduct">Пачки</option>
                        <option  value="deliveryMultimodal">deliveryMultimodal</option>
                        <option  value="deliveryPort">deliveryPort</option>
                        <option  value="deliveryCountry">deliveryCountry</option>
                        <option  value="providerInWork">providerInWork</option>
                        <option  value="recycleStorage">Переработка</option>
                    </select>
                </td>
                <td style="width: auto; align-items: end;">
                    <button class="btn btn-primary" onclick="sendRequestForStatistic(this.id)" th:id="${breedId}">
                        Поиск
                    </button>
                </td>
            </tr>
        </table>
        <div style="display: flex; align-items: center; justify-content: center">
            <div id="piechart" style="width: 900px; height: 500px; justify-content: center">
            </div>
        </div>
    </div>


    <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        let summary = 0.000;

        function drawChart() {

            data = new google.visualization.DataTable();
            data.addColumn('string', 'Place');
            data.addColumn('number', 'Extent');
            data.addRow(['x', 1]);


            var options = {
                title: 'Суммарная кубатура: '+summary.toFixed(3)+" м3",
                pieHole: 0.4,
                // is3D: true,
            };

            var chart = new google.visualization.PieChart(document.getElementById('piechart'));

            chart.draw(data, options);
        }

        function sendRequestForStatistic(breedId) {
            var descriptions = $('#selectDescription').val();
            var sizeOfHeight = $('#selectSizeOfHeight').val();
            var sizeOfWidth = $('#selectSizeOfWidth').val();
            var sizeOfLong = $('#selectSizeOfLong').val();
            var providers = $('#selectProvider').val();
            var stages = $('#selectStage').val();

            console.log(breedId);
            $.ajax({
                method: "post",
                url: "/admin/getStatisticInfo-"+breedId,
                contextType: "application/json",
                data: {
                    descriptions: descriptions,
                    sizeOfHeight: sizeOfHeight,
                    sizeOfWidth: sizeOfWidth,
                    sizeOfLong: sizeOfLong,
                    providers: providers,
                    stages: stages
                },
                traditional: true,
                success: function (statisticInfo) {
                    console.log(statisticInfo);

                    summary = parseFloat(statisticInfo["mainExtent"]);

                    data = new google.visualization.DataTable();
                    data.addColumn('string', 'Place');
                    data.addColumn('number', 'Extent');
                    data.addRow(['x', parseFloat(statisticInfo["dryStorage"])]);
                    console.log(parseFloat(statisticInfo["dryStorage"]));
                    data.addRow(['y', 2]);

                    var options = {
                        title: 'Суммарная кубатура: '+summary.toFixed(3)+" м3",
                        pieHole: 0.4,
                        // is3D: true,
                    };

                    var chart = new google.visualization.PieChart(document.getElementById('piechart'));

                    chart.draw(data, options);
                    // drawChart();
                    // location.reload();
                },
                error: function () {
                    alert("Error");
                }
            });
        }




        function getListOfSelected(selectId){

        }
    </script>

</th:block>






<th:block xmlns:th="http://www.w3.org/1999/xhtml" th:fragment="statisticsOak">
    <div class="tab-pane fade show active container" id="oakStats">
        <h1>Oak</h1>
    </div>
</th:block>