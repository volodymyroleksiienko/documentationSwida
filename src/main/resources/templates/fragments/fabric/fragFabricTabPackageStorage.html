<!--//Package STORAGE TAB-->
<th:block xmlns="http://www.w3.org/1999/xhtml"
          xmlns:th="http://www.w3.org/1999/xhtml" th:fragment="packageStorage"><!-- Пачки -->
    <div class="tab-pane fade show active container-fluid" id="packagedproduct">
        <table class="table table-hover table-striped" id="packagedproducttable">
            <br>
            <thead>
            <tr>
                <th scope="col">id</th>
                <th scope="col">№ пачки</th>
                <th scope="col">Порода</th>
                <th scope="col">Описание</th>
                <th scope="col">Толщина, мм</th>
                <th scope="col">Ширина, мм</th>
                <th scope="col">Длина, мм</th>
                <th scope="col">Кол-во досок, шт</th>
                <th scope="col">Кубатура, м<sup>3</sup></th>
                <th scope="col">Высота, шт</th>
                <th scope="col">Ширина, шт</th>
                <th scope="col">Длина-ФАКТ</th>
                <th scope="col">Высота/Ширина</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="ps, index : ${packagedProductsList}" th:id="${ps.id}">
                <td th:text="${ps.id}"></td>
                <th scope="row" th:text="${ps.codeOfPackage}">20-1С3-2605-1-2805</th>
                <td th:text="${ps.breedOfTree.breed}"></td>
                <td th:text="${ps.breedDescription}"></td>
                <td th:text="${ps.sizeOfHeight}"></td>
                <td th:text="${ps.sizeOfWidth}"></td>
                <td th:text="${ps.sizeOfLong}"></td>
                <td th:text="${ps.countOfDesk}"></td>
                <td th:text="${ps.extent}"></td>
                <td th:text="${ps.countDeskInHeight}"></td>
                <td th:text="${ps.countDeskInWidth}"></td>
                <td th:text="${ps.longFact}"></td>
                <td th:text="${ps.height_width}"></td>
                <td>
                    <button th:if="${btnConfig?.equals('btnON')}" type="button" class="btn btn-primary btn-sm" data-toggle="modal" onclick="addPackageIntoDelivery(this)">
                        <i class="fas fa-plus" data-toggle="tooltip" title="Добавить к погрузке"></i>
                    </button>
                    <button th:if="${btnConfig?.equals('btnON')}" type="button" class="btn btn-primary btn-sm" onclick="packageUnform(this)">
                        <i class="fa fa-times" data-toggle="tooltip" title="Расформировать пачку"></i>
                    </button>
                    <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" onclick="editPackage(this)"><i class="fas fa-pen" data-toggle="tooltip" title="Редактировать"></i></button>
                </td>

            </tr>
            <tfoot>
            <tr>
                <th scope="col">id</th>
                <th scope="col">№ пачки</th>
                <th scope="col">Порода</th>
                <th scope="col">Описание</th>
                <th scope="col">Толщина, мм</th>
                <th scope="col">Ширина, мм</th>
                <th scope="col">Длина, мм</th>
                <th scope="col">Кол-во досок, шт</th>
                <th scope="col">Кубатура, м<sup>3</sup></th>
                <th scope="col">Высота, шт</th>
                <th scope="col">Ширина, шт</th>
                <th scope="col">Длина-ФАКТ</th>
                <th scope="col">Высота/Ширина</th>
                <th></th>
            </tr>
            </tfoot>
            </tbody>
        </table>
        <!-- BUTTON -->
        <div class="float-action-button" th:if="${btnConfig?.equals('btnON')}">
            <button type="button" class="buttons btn btn-primary" title="Добавить пачку" data-toggle="modal" data-placement="left" data-target="#addOwnPackageModal">
                <i class="fa fa-plus"></i>
            </button>
            <button type="button" class="buttons main-button btn btn-primary" title="Добавить к погрузке" data-placement="left" id ="buttonForTransportation">
                <i class="fas fa-truck-loading"></i>
            </button>
        </div>
        <!-- BUTTON -->
    </div>


    <!-- Create own package start -->
    <div class="modal fade" id="addOwnPackageModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="sendForPackageModalHeader">Создаение  пачки</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form th:action="@{'/fabric/addPackagedProductWithoutHistory-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">

                        <!-- Insert rows -->
                        <input type="text" class="form-control" id="sendForPackagesModalId" hidden="hidden" autocomplete="off" >

                        <label class="col-form-label" for="sendForPackageModalCode">Код</label>
                        <input type="text" class="form-control" id="sendForPackageModalCode" required="required" autocomplete="off" name="codeOfPackage">

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-6">
                                <label class="control-label" for="sendForPackageModalMaterial">Порода</label>
                                <th:block th:each="b : ${breedOfTreeList}" >
                                    <th:block th:if="${b.id==breedId}">
                                        <input type="text" class="form-control"  id="sendForPackageModalMaterial" required="required" autocomplete="off" disabled="disabled"  th:value="${b.breed}">
                                    </th:block>
                                </th:block>
                            </div>
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageModalMaterialDescr">Описание</label>
                                <input type="text" class="form-control" id="sendForPackageModalMaterialDescr" autocomplete="off"  name="breedDescription">
                            </div>
                        </div>
<!--                        -->
                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageHeight">Толщина</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageHeight" required="required" autocomplete="off" placeholder="мм" name="sizeOfHeight">
                            </div>
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageWidth">Ширина</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageWidth" required="required" autocomplete="off" placeholder="мм" name="sizeOfWidth">
                            </div>
                        </div>

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageLength">Длина</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageLength" required="required" autocomplete="off" placeholder="мм" name="sizeOfLong">
                            </div>
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageModalCount">Количество досок</label>
                                <input type="number" min="1" step="1" class="form-control" id="sendForPackageModalCount" required="required" autocomplete="off" placeholder="шт" name="countOfDesk">
                            </div>
                        </div>
<!--                        -->

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageModalExtent">Кубатура</label>
                                <input type="number" step="any" pattern="[0-9]*\.?[0-9]*" class="form-control" id="sendForPackageModalExtent" required="required" autocomplete="off" placeholder="м3" disabled="disabled">
                            </div>
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageModalPacksCount">Количество пачек</label>
                                <input type="number" min="1" step="1" placeholder="шт" class="form-control" id="sendForPackageModalPacksCount" required="required" autocomplete="off" name="countOfPacks">
                            </div>
                        </div>

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageModalWidthPc">Ширина</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageModalWidthPc" required="required" autocomplete="off" placeholder="шт" name="countDeskInWidth">
                            </div>
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageHeightPc">Высота</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageHeightPc" required="required" autocomplete="off" placeholder="шт" name="countDeskInHeight">
                            </div>
                        </div>

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageModalLengthFact">Длина-ФАКТ</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageModalLengthFact" required="required" autocomplete="off" placeholder="мм" name="longFact">
                            </div>

                            <div class="col-6">
                                <label class="col-form-label" for="sendForPackageModalHeightWidth">Высота/Ширина</label>
                                <input type="text" class="form-control" id="sendForPackageModalHeightWidth" required="required" autocomplete="off" placeholder="в/ш" name="height_width">
                            </div>
                        </div>
                        <!-- Insert rows -->
                    </div>
                    <div class="modal-footer">
                        <button type="button submit" class="btn btn-primary">Создать</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!--  Create own package end  -->


    <!-- Edit package start -->
    <div class="modal fade" id="editPackageModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editPackageModalHeader"></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form th:action="@{'/fabric/editPack-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">

                        <!-- Insert rows -->
                        <input type="text" class="form-control" id="editPackagesModalId" hidden="hidden" autocomplete="off" name="id">

                        <label class="col-form-label" for="editPackageModalCode">Код</label>
                        <input type="text" class="form-control" id="editPackageModalCode" required="required" autocomplete="off" name="codeOfPackage">

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-6">
                                <label class="control-label" for="editPackageModalMaterial">Порода</label>
                                <th:block th:each="b : ${breedOfTreeList}" >
                                    <th:block th:if="${b.id==breedId}">
                                        <input type="text" class="form-control"  id="editPackageModalMaterial" required="required" autocomplete="off" disabled="disabled" th:value="${b.breed}">
                                    </th:block>
                                </th:block>
                            </div>
                            <div class="col-6">
                                <label class="col-form-label" for="editPackageModalMaterialDescr">Описание</label>
                                <input type="text" class="form-control" id="editPackageModalMaterialDescr" autocomplete="off"  name="breedDescription">
                            </div>
                        </div>
                        <!--                        -->
                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageHeight">Толщина</label>
                                <input type="number" min="1" class="form-control" id="editPackageHeight" required="required" autocomplete="off" placeholder="мм" name="sizeOfHeight">
                            </div>
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageWidth">Ширина</label>
                                <input type="number" min="1" class="form-control" id="editPackageWidth" required="required" autocomplete="off" placeholder="мм" name="sizeOfWidth">
                            </div>
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageLength">Длина</label>
                                <input type="number" min="1" class="form-control" id="editPackageLength" required="required" autocomplete="off" placeholder="мм" name="sizeOfLong">
                            </div>
                        </div>

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageModalCount">Кол-во досок</label>
                                <input type="number" min="1" step="1" class="form-control" id="editPackageModalCount" required="required" autocomplete="off" placeholder="шт" name="countOfDesk">
                            </div>
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageModalExtent">Кубатура</label>
                                <input type="number" step="any" pattern="[0-9]*\.?[0-9]*" class="form-control" id="editPackageModalExtent" required="required" autocomplete="off" placeholder="м3" disabled="disabled">
                            </div>
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageModalLengthFact">Длина-ФАКТ</label>
                                <input type="number" min="1" class="form-control" id="editPackageModalLengthFact" required="required" autocomplete="off" placeholder="мм" name="longFact">
                            </div>
                        </div>
                        <!--                        -->

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageModalWidthPc">Ширина</label>
                                <input type="number" min="1" class="form-control" id="editPackageModalWidthPc" required="required" autocomplete="off" placeholder="шт" name="countDeskInWidth">
                            </div>
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageHeightPc">Высота</label>
                                <input type="number" min="1" class="form-control" id="editPackageHeightPc" required="required" autocomplete="off" placeholder="шт" name="countDeskInHeight">
                            </div>
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageModalHeightWidth">Выс./Шир.</label>
                                <input type="text" class="form-control" id="editPackageModalHeightWidth" required="required" autocomplete="off" placeholder="в/ш" name="height_width">
                            </div>
                        </div>
                        <!-- Insert rows -->
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Сохранить</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function editPackage(btnObj) {
            var trObj = btnObj.parentElement.parentElement;
            var trId =  $(trObj).attr('id');
            $('#editPackagesModalId').val(trId);
            console.log(  $(trObj).attr('id'));
            var codeOfPackage = $(trObj).find('th:eq(0)').text();
            $('#editPackageModalHeader').text("Редактировать пачку №"+codeOfPackage);

            var code =                          $(trObj).find('th:eq(0)').text();
            var material =                      $(trObj).find('td:eq(0)').text();
            var description =                   $(trObj).find('td:eq(1)').text();
            var thickness =                     $(trObj).find('td:eq(2)').text();
            var width =                         $(trObj).find('td:eq(3)').text();
            var length =                        $(trObj).find('td:eq(4)').text();
            var count =                         $(trObj).find('td:eq(5)').text();
            var extent =                        $(trObj).find('td:eq(6)').text();
            var widthPc =                       $(trObj).find('td:eq(7)').text();
            var heightPc =                      $(trObj).find('td:eq(8)').text();
            var lengthFact =                    $(trObj).find('td:eq(9)').text();
            var heightWidth =                   $(trObj).find('td:eq(10)').text();

            $('#editPackageModalCode')          .val(code);
            $('#editPackageModalMaterial')      .val(material);
            $('#editPackageModalMaterialDescr') .val(description);
            $('#editPackageHeight')             .val(thickness);
            $('#editPackageWidth')              .val(width);
            $('#editPackageLength')             .val(length);
            $('#editPackageModalCount')         .val(count);
            $('#editPackageModalExtent')        .val(extent);
            $('#editPackageModalWidthPc')       .val(widthPc);
            $('#editPackageHeightPc')           .val(heightPc);
            $('#editPackageModalLengthFact')    .val(lengthFact);
            $('#editPackageModalHeightWidth')   .val(heightWidth);


            $('#editPackageModal').modal('show');
        }
    </script>
    <!--  Edit package end  -->


    <!-- Send list for transportation modal begin -->
    <div class="modal fade" id="sendForTransportationModal">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Погрузить</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form th:action="@{'/fabric/createDeliveryDoc-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">
                        <!-- Selected row -->
                        <table class="table table-hover table-striped" id="tableForTransportation">
                            <thead>
                            <tr>
                                <th scope="col">id</th>
                                <th scope="col">№ пачки</th>
                                <th scope="col">Порода</th>
                                <th scope="col">Опис.</th>
                                <th scope="col">Толщ.</th>
                                <th scope="col">Шир.</th>
                                <th scope="col">Дл.</th>
                                <th scope="col">Кол-во</th>
                                <th scope="col">Куб.</th>
                                <th scope="col">В/Ш</th>
                                <th></th>
                            </tr>
                            </thead>
                            <tbody id="listOfPackageId">
                            <!-- <tr></tr> -->
                            </tbody>
                        </table>
                        <!-- Selected row -->

                        <!-- Insert rows -->
                        <div class="form-group container">
                            <input type="text" class="form-control" id="addRawStorageId" hidden="hidden" autocomplete="off">
                            <input type="text" hidden="hidden" id="breedID" th:value="${breedId}">
                            <input type="text" hidden="hidden" id="userID" th:value="${userId}">

                            <div class="form-group row d-flex" style="align-items: flex-end;margin-bottom: 0">
                                <div class="col-3">
                                    <label class="col-form-label" for="addIdOfTruck">№ выгрузки</label>
                                    <input type="text" class="form-control" placeholder="" id="addIdOfTruck" pattern="[0-9]*\.?[0-9]*" autocomplete="off" required="required">
                                </div>
                                <div class="col-6">
                                    <label for="driverCredentionals" class="col-form-label">Имя, Фамилия водителя</label>
                                    <input type="text" class="form-control" id="driverCredentionals" required="required" autocomplete="off">
                                </div>
                                <div class="col-3">
                                    <label for="driverPhone" class="col-form-label">Телефон</label>
                                    <input type="text" class="form-control" id="driverPhone" required="required" autocomplete="off">
                                </div>
                            </div>

                            <div class="form-group row d-flex" style="align-items: flex-end;margin-bottom: 0">
                                <div class="col-3">
                                    <label for="numberOfTruck" class="col-form-label">Номер фуры</label>
                                    <input type="text" class="form-control" id="numberOfTruck" required="required" autocomplete="off">
                                </div>
                                <div class="col-3">
                                    <label for="numberOfTrailer" class="col-form-label">Номер прицепа</label>
                                    <input type="text" class="form-control" id="numberOfTrailer" required="required" autocomplete="off">
                                </div>
                                <div class="col-3">
                                    <label for="packDateInput" class="col-form-label">Дата выгрузки</label>
                                    <input class="form-control" type="date" id="packDateInput" required="required" name="dateOfUnloading">
                                </div>
                                <div class="col-3">
                                    <label for="packTimeInput" class="col-form-label">Время выгрузки</label>
                                    <input type="text" class="form-control" id="packTimeInput" required="required" autocomplete="off" name="timeOfUnloading">
                                </div>
                            </div>

                            <div class="form-group row d-flex" style="align-items: flex-end;margin-bottom: 0">
                                <div class="col-3">
                                    <label class="col-form-label" for="packContractId" >Контракт</label>
                                    <input type="text" class="form-control" list="contractList" id="packContractId" required="required" autocomplete="off" onchange="setHiddenValue(this)">
                                    <datalist id="contractList">
                                        <option th:each="contract : ${contractList}"  th:data-value="${contract.id}" th:text="${contract.codeOfOrder}" th:label="${contract?.contrAgent?.nameOfAgent}"></option>
                                    </datalist>
                                    <input type="hidden" name="orderInfo.id" id="packContractId-hidden">
                                </div>
                                <div class="col-3">
                                    <label for="packDeliveryDestination" class="col-form-label">Пункт назначения</label>
                                    <input type="text" class="form-control" list="destinationType" id="packDeliveryDestination" required="required" autocomplete="off" name="destinationType">
                                    <datalist id="destinationType">
                                        <option value="MULTIMODAL">
                                        <option value="PORT">
                                        <option value="COUNTRY">
                                    </datalist>
                                </div>
                                <div class="col-6">
                                    <label class="col-form-label" for="addDeliveryDescription">Примечания</label>
                                    <input type="text" class="form-control" placeholder="" id="addDeliveryDescription"  autocomplete="off">
                                </div>
                            </div>

                        </div>
                        <script type="text/javascript">
                            document.querySelector("#packDateInput").valueAsDate = new Date();
                        </script>
                        <!-- Insert rows -->
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" onclick="sendRequestToCreateDeleviry()">Отправить</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Send list for transportation end -->

<!--    Delivery-->
    <div class="modal fade" id="sendPackModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="sendPackageHeader"></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <!--       TUT         -->
                <form th:action="@{'/fabric/addPackToExistDeliveryDoc-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">
                        <!--       TUT                 -->

                        <div class="form-group">
                            <input type="text" class="form-control" id="selectedPackModalId" hidden="hidden" autocomplete="off" name="packId">

                            <label class="col-form-label" for="selectTruck">Машина</label>
                            <input type="text" class="form-control" list="trucksList" id="selectTruck" required="required" autocomplete="off" onchange="setHiddenValue(this)">
                            <datalist id="trucksList">
                                <option th:each="b : ${deliveryList}"  th:data-value="${b.id}" th:text="${b.driverInfo.idOfTruck}"></option>
                            </datalist>
                            <input type="hidden" name="driverId" id="selectTruck-hidden">


                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button submit" class="btn btn-primary">Добавить</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        function addPackageIntoDelivery(btnObj) {
            var trObj = btnObj.parentElement.parentElement;
            var trId =  $(trObj).attr('id');
            $('#selectedPackModalId').val(trId);
            console.log(  $(trObj).attr('id'));
            var codeOfSelectedPackage = $(trObj).find('th:eq(0)').text();

            $('#sendPackageHeader').text("Добавить пачку "+codeOfSelectedPackage+" к существующей доставке");

            $('#sendPackModal').modal('show');
        }
    </script>
<!--    Delivery end-->

    <!--  Modal confirmation  -->
    <div class="modal fade" id="unformPackModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Расформирование пачек</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <!--       TUT         -->
                <form th:action="@{'/fabric/unformPackagedProduct-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">
                <!--       TUT                 -->

                        <div class="form-group">
                            <input type="text" class="form-control" id="unformPackModalId" hidden="hidden" autocomplete="off" name="id">

                            <p id="unformPackModalConfirmation">
                                Вы уверены, что хотите расформировать пачку ?
                            </p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button submit" class="btn btn-primary">Расформировать</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function packageUnform(btnObj) {
            var trObj = btnObj.parentElement.parentElement;
            var trId =  $(trObj).attr('id');
            $('#unformPackModalId').val(trId);
            console.log(  $(trObj).attr('id'));
            var codeOfPackage = $(trObj).find('th:eq(0)').text();

            $('#unformPackModalConfirmation').text("Вы уверены, что хотите расформировать пачку "+codeOfPackage+" ?");
            $('#unformPackModal').modal('show');
        }
    </script>
    <!--  Modal confirmation  -->

    <!-- Пачки -->


    <!-- Transportation -->
    <script type="text/javascript">
        // listener for opening and closing
        $('#transportationtable tbody').on('click', 'td.details-control', function () {
            var tr = $(this).closest('tr');
            var row = table.row( tr );

            if ( row.child.isShown() ) {
                // already open
                row.child.hide();
                tr.removeClass('shown');
            }
            else {
                // open row
                row.child( format(row.data()) ).show();
                tr.addClass('shown');
            }
        } );

        function sendRequestToCreateDeleviry() {
            var arrOfTr = document.getElementById("listOfPackageId").getElementsByTagName("tr");
            console.log("arr length = "+arrOfTr.length);
            var idOfTruck1 = $("#addIdOfTruck").val();
            var name1 = $("#driverCredentionals").val();
            var phone1 = $("#driverPhone").val();
            var numberOfTruck1 = $("#numberOfTruck").val();
            var numberOfTrailer1 = $("#numberOfTrailer").val();
            var date1 = $("#packDateInput").val();
            var time1 = $("#packTimeInput").val();
            var breedID = $("#breedID").val();
            var userID = $("#userID").val();
            var contractName1 = $("#packContractId-hidden").val();
            var deliveryDestination1 = $("#packDeliveryDestination").val();
            var description1 = $("#addDeliveryDescription").val();


            var arrayOfId = [];

            for (var i = 0; i<arrOfTr.length;i++){
                arrayOfId[i] = $(arrOfTr[i]).find('td:eq(0)').text();
            }

            if (arrayOfId[0]!="No data available in table" && idOfTruck1 != "" && name1 != "" && phone1 != "" && numberOfTruck1 != "" && numberOfTrailer1 != "" && date1 != "" && time1 != "" && contractName1 != "" && deliveryDestination1!="" && description1!=""){

            $.ajax({
                method: "post",
                url: "/createDeliveryDoc-"+userID+"-"+breedID,
                contextType: "application/json",
                data: {
                    list: arrayOfId,
                    name: name1,
                    phone: phone1,
                    idOfTruck: idOfTruck1,
                    numberOfTruck: numberOfTruck1,
                    numberOfTrailer: numberOfTrailer1,
                    dateOfUnloading: date1,
                    timeOfUnloading: time1,
                    contractName: contractName1,
                    deliveryDestination: deliveryDestination1,
                    description: description1
                },
                traditional: true,
                success: function () {
                    location.reload();
                },
                error: function () {
                   alert("Error");
                }
            });}
            else {
                alert("Заполните все поля!");
            }

        }
    </script>


</th:block>














<!-- OAK Package Storage-->
<!-- OAK Package Storage-->
<!-- OAK Package Storage-->
<!-- OAK Package Storage-->

<th:block xmlns="http://www.w3.org/1999/xhtml"
          xmlns:th="http://www.w3.org/1999/xhtml" th:fragment="packageStorageOak">

        <!-- Транспортировка -->
        <div class="tab-pane fade show active container-fluid" id="transportation">

            <table class="table table-hover table-striped" id="packageOakTableId">
                <br>
                <thead>
                <tr>
                    <th></th>
                    <th scope="col">id</th>
                    <th scope="col">№ пачки</th>
                    <th scope="col">Качество</th>
                    <th scope="col">Размер</th>
                    <th scope="col">Длина</th>
                    <th scope="col">Сум. ширина</th>
                    <th scope="col">Кол. досок</th>
                    <th scope="col">Кубатура</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                      <div th:each="p, index : ${packageOakList}">
                              <tr class="outer-table" th:id="${p.id}">
                                  <td  class="details-control" onclick="javascript:$('#parent'+this.id).toggle();" th:id="${p.id}"></td>
                                  <td>tut id</td>
                                  <th th:text="${p.codeOfPackage}"></th>
                                  <td th:text="${p.quality}"></td>
                                  <td th:text="${p.sizeOfHeight}"></td>
                                  <td th:text="${p.sizeOfLong}"></td>
                                  <td th:text="${p.sumWidthOfAllDesk}"></td>
                                  <td th:text="${p.countOfDesk}"></td>
                                  <td th:text="${p.extent}"></td>
                                  <td>
                                      <button th:if="${btnConfig?.equals('btnON')}" type="button" class="btn btn-primary btn-sm" data-toggle="modal" onclick="addOakPackageItems(this)"><i class="fas fa-plus" data-toggle="tooltip" title="Добавить позицию к пачке"></i></button>
                                      <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" onclick="editOakPackage(this)"><i class="fas fa-pen" data-toggle="tooltip" title="Редактировать"></i></button>
                                      <button th:if="${btnConfig?.equals('btnON')}" type="button" class="btn btn-primary btn-sm" data-toggle="modal" onclick="addPackageIntoOakDelivery(this)"><i class="fas fa-truck-loading" data-toggle="tooltip" title="Добавить к существующей погрузке"></i></button>
                                      <button th:if="${btnConfig?.equals('btnON')}" type="button" class="btn btn-primary btn-sm" onclick="packageOakUnform(this)"><i class="fa fa-times" data-toggle="tooltip" title="Расформировать пачку"></i></button>
                                  </td>
                              </tr>
                              <tr style="display:none" th:id="'parent'+${p.id}">
                                  <td colspan="13" class="child-table">
                                      <table class="table table-hover table-striped parent-table" id="packages">
                                          <thead>
                                              <tr>
                                                  <th scope="col">Ширина, мм</th>
                                                  <th scope="col">Количество досок</th>
                                                  <th></th>
                                              </tr>
                                          </thead>
                                          <tbody>
                                              <tr th:each="l, index : ${p.deskOakList}" th:id="${l.id}">
                                                  <td th:text="${l.sizeOfWidth}"></td>
                                                  <td th:text="${l.countOfDesk}"></td>
                                                  <td style="text-align: end">
                                                      <button th:if="${btnConfig?.equals('btnON')}" type="button" class="btn btn-primary btn-sm" data-toggle="modal" onclick="editOakPackageItem(this)"><i class="fas fa-pen" data-toggle="tooltip" title="Редактировать"></i></button>
                                                      <button th:if="${btnConfig?.equals('btnON')}" type="button" class="btn btn-primary btn-sm" data-toggle="modal" onclick="deleteOakPackageItem(this)"><i class="fa fa-times" data-toggle="tooltip" title="Удалить"></i></button>
                                                  </td>
                                              </tr>
                                          </tbody>
                                      </table>
                                  </td>
                                  <td style="display:none"></td>
                                  <td style="display:none"></td>
                                  <td style="display:none"></td>
                                  <td style="display:none"></td>
                                  <td style="display:none"></td>
                                  <td style="display:none"></td>
                                  <td style="display:none"></td>
                                  <td style="display:none"></td>
                                  <td style="display:none"></td>
                              </tr>
                      </div>
                </tbody>
                <tfoot>
                <tr>
                    <th></th>
                    <th scope="col">id</th>
                    <th scope="col">№ пачки</th>
                    <th scope="col">Качество</th>
                    <th scope="col">Размер</th>
                    <th scope="col">Длина</th>
                    <th scope="col">Сум. ширина</th>
                    <th scope="col">Кол. досок</th>
                    <th scope="col">Кубатура</th>
                    <th></th>
                </tr>
                </tfoot>
            </table>
            <!-- BUTTON -->
            <div class="float-action-button" th:if="${btnConfig?.equals('btnON')}">
                <button type="button" class="buttons btn btn-primary" title="Добавить пачку" data-toggle="modal" data-placement="left" data-target="#addOwnOakPackageModal">
                    <i class="fa fa-plus"></i>
                </button>
                <button type="button" class="buttons main-button btn btn-primary" title="Добавить к погрузке" data-placement="left" id ="buttonForOakTransportation">
                    <i class="fas fa-truck-loading"></i>
                </button>
            </div>
            <!-- BUTTON -->
        </div>

    <!-- Create own package start -->
    <div class="modal fade" id="addOwnOakPackageModal">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title ">Создание пачки</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form>
                    <div class="modal-body">

                        <div class="form-group row">
                            <input type="text" id="createPackageModalIdOak" hidden="hidden" >
                            <input type="text" hidden="hidden" id="breedId" th:value="${breedId}">
                            <input type="text" hidden="hidden" id="userId" th:value="${userId}">

                            <div class="col-3">
                                <label class="col-form-label" for="sendForPackageModalCodeOak">Код пачки</label>
                                <input type="text" class="form-control" id="sendForPackageModalCodeOak" required="required" autocomplete="off">
                            </div>
                            <div class="col-3">
                                <label class="control-label" for="sendForPackageModalQualityOak" style="padding-top: 7px">Качество</label>
                                <input type="text" class="form-control" id="sendForPackageModalQualityOak" required="required">
                            </div>
                            <div class="col-3">
                                <label class="control-label" for="sendForPackageModalSizeOak" style="padding-top: 7px">Размер</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageModalSizeOak" required="required" placeholder="мм">
                            </div>
                            <div class="col-3">
                                <label class="col-form-label" for="sendForPackageModalLengthOak">Длина</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageModalLengthOak" required="required" autocomplete="off" placeholder="мм">
                            </div>
                        </div>

                        <hr>

                        <div class="form-group row d-flex" style="align-items: flex-end">

                            <div class="col-5">
                                <label class="col-form-label" for="sendForPackageModalWidthOak">Ширина</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageModalWidthOak" required="required" autocomplete="off" placeholder="мм">
                            </div>
                            <div class="col-5">
                                <label class="control-label" for="sendForPackageModalCountOak" style="padding-top: 7px">Количество</label>
                                <input type="number" min="1" class="form-control" id="sendForPackageModalCountOak" required="required" autocomplete="off" placeholder="шт">
                            </div>
                            <div class="col-2">
                                <button id="buttonForAddingOakRow" type="button" class="btn btn-primary" style="width: 100%">Добавить</button>
                            </div>
                        </div>

                        <table class="table table-hover table-striped" id="tableForTransportationOak">
                            <thead>
                            <tr>
                                <th scope="col">Толщина, мм</th>
                                <th scope="col">Количество досок, шт</th>
                                <th></th>
                            </tr>
                            </thead>

                            <tbody id="listOfOakPackagesId">
                            <!-- <tr></tr> -->
                            </tbody>

                            <tfoot>
                            <th scope="col">Толщина, мм</th>
                            <th scope="col">Количество досок, шт</th>
                            <th></th>
                            </tfoot>

                        </table>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="createPackageOak" onclick="createOakPackageForm()">Создать</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add package content start   -->
    <div class="modal fade" id="addOakPackageContentModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addOakPackageItemsModalHeader"> </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form th:action="@{'/fabric/addPackOakDesc-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">
                        <input type="number" id="addOakPackageItemsPackId" hidden="" name="packageId">

                        <div class="form-group row d-flex" style="align-items: flex-end;margin-bottom: 0">
                            <div class="col-6">
                                <label for="addOakPackageContentWidth" class="col-form-label">Ширина</label>
                                <input type="number" pattern="[0-9]*\.?[0-9]*" placeholder="мм" class="form-control" id="addOakPackageContentWidth" required="required" autocomplete="off" name="width">
                            </div>
                            <div class="col-6">
                                <label class="col-form-label" for="addOakPackageContentCount">Количество досок</label>
                                <input type="number" pattern="[0-9]*\.?[0-9]*" placeholder="шт" class="form-control"  id="addOakPackageContentCount"  autocomplete="off" required="required" name="count">
                            </div>
                        </div>
                    </div>
                    <!-- Insert rows -->

                    <div class="modal-footer">
                        <button type="button submit" class="btn btn-primary">Добавить</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        function addOakPackageItems(btnObj) {
            let trObj = btnObj.parentElement.parentElement;
            let trId =              $(trObj).attr('id');
            let packageCode =       $(trObj).find('th:eq(0)').text();

            console.log("row id: "+trId);

            $('#addOakPackageItemsModalHeader').text("Добавить позицию к пачке "+ packageCode);
            $('#addOakPackageItemsPackId').val(trId);

            $('#addOakPackageContentModal').modal('show');
        }
    </script>
    <!-- Add package content end   -->


    <!-- Edit package start -->
    <div class="modal fade" id="editOakPackageModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editOakPackageModalHeader"></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form th:action="@{'/fabric/editPackOak-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">
                        <input type="text" id="editPackageModalIdOak" hidden="hidden" name = "id">

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-6">
                                <label class="col-form-label" for="editPackageModalCodeOak">Код пачки</label>
                                <input type="text" class="form-control" id="editPackageModalCodeOak" required="required" autocomplete="off" name="codeOfPackage">
                            </div>
                            <div class="col-6">
                                <label class="control-label" for="editPackageModalQualityOak" style="padding-top: 7px">Качество</label>
                                <input type="text" class="form-control" id="editPackageModalQualityOak" required="required" name="quality">
                            </div>
                        </div>

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-4">
                                <label class="control-label" for="editPackageModalSizeOak" style="padding-top: 7px">Размер</label>
                                <input type="number" min="1" class="form-control" id="editPackageModalSizeOak" required="required" placeholder="мм" name="sizeOfHeight">
                            </div>
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageModalLengthOak">Длина</label>
                                <input type="number" min="1" class="form-control" id="editPackageModalLengthOak" required="required" autocomplete="off" placeholder="мм" name="sizeOfLong">
                            </div>
                            <div class="col-4">
                                <label class="col-form-label" for="editPackageModalSumLengthOak">Сум. ширина</label>
                                <input type="number" min="1" class="form-control" id="editPackageModalSumLengthOak" required="required" autocomplete="off" placeholder="мм" disabled="disabled">
                            </div>
                        </div>

                        <div class="form-group row d-flex" style="align-items: flex-end; margin-bottom: 0">
                            <div class="col-6">
                                <label class="col-form-label" for="editPackageModalDeskCountOak">Кол. досок</label>
                                <input type="text" class="form-control" id="editPackageModalDeskCountOak" required="required" autocomplete="off" disabled="disabled">
                            </div>
                            <div class="col-6">
                                <label class="control-label" for="editPackageModalExtentOak" style="padding-top: 7px">Кубатура</label>
                                <input type="text" class="form-control" id="editPackageModalExtentOak" required="required" disabled="disabled">
                            </div>
                        </div>

                    </div>

                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Сохранить</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function editOakPackage(btnObj) {
            var trObj = btnObj.parentElement.parentElement;
            var trId = $(trObj).find('td:eq(0)').attr('id');
            $('#editPackageModalIdOak').val(trId);
            console.log(  $(trObj).attr('id'));
            var codeOfPackage = $(trObj).find('th:eq(0)').text();
            $('#editOakPackageModalHeader').text("Редактировать пачку №"+codeOfPackage);

            var code =                          $(trObj).find('th:eq(0)').text();
            var quality =                       $(trObj).find('td:eq(1)').text();
            var size =                          $(trObj).find('td:eq(2)').text();
            var length =                        $(trObj).find('td:eq(3)').text();
            var sumLength =                     $(trObj).find('td:eq(4)').text();
            var count =                         $(trObj).find('td:eq(5)').text();
            var extent =                        $(trObj).find('td:eq(6)').text();

            $('#editPackageModalCodeOak')       .val(code);
            $('#editPackageModalQualityOak')    .val(quality);
            $('#editPackageModalSizeOak')       .val(size);
            $('#editPackageModalLengthOak')     .val(length);
            $('#editPackageModalSumLengthOak')  .val(sumLength);
            $('#editPackageModalDeskCountOak')  .val(count);
            $('#editPackageModalExtentOak')     .val(extent);

            $('#editOakPackageModal').modal('show');
        }
    </script>
    <!--  Edit package end  -->

    <!-- Edit package content start   -->
    <div class="modal fade" id="editOakPackageContentModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Редактировать</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form th:action="@{'/fabric/editPackOakDesc-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">
                        <input type="number" id="oakPackageContentId" hidden="" name="rowId">
                        <input type="number" id="editOakPackageId" hidden="" name="packageId">

                        <div class="form-group row d-flex" style="align-items: flex-end;margin-bottom: 0">
                            <div class="col-6">
                                <label for="editOakPackageContentWidth" class="col-form-label">Ширина, мм</label>
                                <input type="number" pattern="[0-9]*\.?[0-9]*" placeholder="мм" class="form-control" id="editOakPackageContentWidth" required="required" autocomplete="off" name="width">
                            </div>
                            <div class="col-6">
                                <label class="col-form-label" for="editOakPackageContentCount">Количество досок</label>
                                <input type="number" pattern="[0-9]*\.?[0-9]*" placeholder="шт" class="form-control"  id="editOakPackageContentCount"  autocomplete="off" required="required" name="count">
                            </div>
                        </div>
                    </div>
                    <!-- Insert rows -->

                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Сохранить</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function editOakPackageItem(btnObj) {
            let trObj = btnObj.parentElement.parentElement;
            let trId =              $(trObj).attr('id');
            console.log("row id: "+trId);

            let expandedObj = trObj.parentElement.parentElement.parentElement.parentElement;
            let expandedId = $(expandedObj).attr('id');
            console.log("string-id: "+expandedId);
            let packageId = expandedId.replace(/\D+/g, "");
            console.log("parent-id: "+packageId);

            $('#editOakPackageId').val(packageId);


            var width =             $(trObj).find('td:eq(0)').text();
            var count =             $(trObj).find('td:eq(1)').text();

            $('#oakPackageContentId')            .val(trId);
            $('#editOakPackageContentWidth')     .val(width);
            $('#editOakPackageContentCount')     .val(count);

            $('#editOakPackageContentModal').modal('show');
        }
    </script>
    <!-- Edit package content end   -->

    <!--  Modal package item delete confirmation start -->
    <div class="modal fade" id="deleteOakPackItemModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Удаление</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <!--       TUT         -->
                <form th:action="@{'/fabric/deletePackOakDesc-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">

                        <div class="form-group">
                            <input type="text" class="form-control" id="deleteOakPackId" hidden="hidden" autocomplete="off" name="packageId">
                            <input type="text" class="form-control" id="deleteOakPackItemModalId" hidden="hidden" autocomplete="off" name="id">

                            <p id="deleteOakPackItemModalConfirmation">
                            </p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button submit" class="btn btn-primary">Удалить</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        function deleteOakPackageItem(btnObj) {
            let trObj = btnObj.parentElement.parentElement;
            let trId =  $(trObj).attr('id');
            $('#deleteOakPackItemModalId').val(trId);
            console.log("row id: "+trId);

            let expandedObj = trObj.parentElement.parentElement.parentElement.parentElement;
            let expandedId = $(expandedObj).attr('id');
            console.log("string-id: "+expandedId);
            let packageId = expandedId.replace(/\D+/g, "");
            console.log("id: "+packageId);

            $('#deleteOakPackId').val(packageId);

            let width = $(trObj).find('td:eq(0)').text();
            let count = $(trObj).find('td:eq(1)').text();

            $('#deleteOakPackItemModalConfirmation').text(" Вы уверены, что хотите удалить позицию: "+width+"мм / "+count+"шт?");
            $('#deleteOakPackItemModal').modal('show');
        }
    </script>
    <!--  Modal package item delete confirmation end -->


    <!-- Send oak list for transportation modal begin MODAL -->
    <div class="modal fade" id="sendOakListForTransportationModal">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Погрузить</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form th:action="@{'/fabric/createDeliveryDoc-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">
                        <!-- Selected rows -->
                        <table class="table table-hover table-striped" id="tableForOakTransportation">
                            <br>
                            <thead>
                            <tr>
                                <th></th>
                                <th scope="col">id</th>
                                <th scope="col">№ пачки</th>
                                <th scope="col">Качество</th>
                                <th scope="col">Размер</th>
                                <th scope="col">Длина</th>
                                <th scope="col">Сум. ширина</th>
                                <th scope="col">Кол. досок</th>
                                <th scope="col">Кубатура</th>
                                <th></th>
                            </tr>
                            </thead>
                            <tbody id="listOfPackagesOakId">

                            </tbody>
                            <tfoot>
                            <tr>
                                <th></th>
                                <th scope="col">id</th>
                                <th scope="col">№ пачки</th>
                                <th scope="col">Качество</th>
                                <th scope="col">Размер</th>
                                <th scope="col">Длина</th>
                                <th scope="col">Сум. ширина</th>
                                <th scope="col">Кол. досок</th>
                                <th scope="col">Кубатура</th>
                                <th></th>
                            </tr>
                            </tfoot>
                        </table>
                        <hr>

                        <!-- Selected rows -->

                        <!-- Insert rows -->
                        <div class="form-group container">
                            <input type="text" class="form-control" id="addRawStorageId" hidden="hidden" autocomplete="off">
                            <input type="text" hidden="hidden" id="breedID" th:value="${breedId}">
                            <input type="text" hidden="hidden" id="userID" th:value="${userId}">

                            <div class="form-group row d-flex" style="align-items: flex-end;margin-bottom: 0">
                                <div class="col-3">
                                    <label class="col-form-label" for="addIdOfTruck">№ выгрузки</label>
                                    <input type="text" class="form-control" placeholder="" id="addIdOfTruck" pattern="[0-9]*\.?[0-9]*" autocomplete="off" required="required">
                                </div>
                                <div class="col-6">
                                    <label for="driverCredentionals" class="col-form-label">Имя, Фамилия водителя</label>
                                    <input type="text" class="form-control" id="driverCredentionals" required="required" autocomplete="off">
                                </div>
                                <div class="col-3">
                                    <label for="driverPhone" class="col-form-label">Телефон</label>
                                    <input type="text" class="form-control" id="driverPhone" required="required" autocomplete="off">
                                </div>
                            </div>

                            <div class="form-group row d-flex" style="align-items: flex-end;margin-bottom: 0">
                                <div class="col-3">
                                    <label for="numberOfTruck" class="col-form-label">Номер фуры</label>
                                    <input type="text" class="form-control" id="numberOfTruck" required="required" autocomplete="off">
                                </div>
                                <div class="col-3">
                                    <label for="numberOfTrailer" class="col-form-label">Номер прицепа</label>
                                    <input type="text" class="form-control" id="numberOfTrailer" required="required" autocomplete="off">
                                </div>
                                <div class="col-3">
                                    <label for="packDateInput" class="col-form-label">Дата выгрузки</label>
                                    <input class="form-control" type="date" id="packDateInput" required="required" name="dateOfUnloading">
                                </div>
                                <div class="col-3">
                                    <label for="packTimeInput" class="col-form-label">Время выгрузки</label>
                                    <input type="text" class="form-control" id="packTimeInput" required="required" autocomplete="off" name="timeOfUnloading">
                                </div>
                            </div>

                            <div class="form-group row d-flex" style="align-items: flex-end;margin-bottom: 0">
                                <div class="col-3">
                                    <label class="col-form-label" for="packContractId" >Контракт</label>
                                    <input type="text" class="form-control" list="contractList" id="packContractId" required="required" autocomplete="off" onchange="setHiddenValue(this)">
                                    <datalist id="contractList">
                                        <option th:each="contract : ${contractList}"  th:data-value="${contract.id}" th:text="${contract.codeOfOrder}" th:label="${contract?.contrAgent?.nameOfAgent}"></option>
                                    </datalist>
                                    <input type="hidden" name="orderInfo.id" id="packContractId-hidden">
                                </div>
                                <div class="col-3">
                                    <label for="packDeliveryDestination" class="col-form-label">Пункт назначения</label>
                                    <input type="text" class="form-control" list="destinationType" id="packDeliveryDestination" required="required" autocomplete="off" name="destinationType">
                                    <datalist id="destinationType">
                                        <option value="PORT">
                                        <option value="COUNTRY">
                                    </datalist>
                                </div>
                                <div class="col-6">
                                    <label class="col-form-label" for="addDeliveryDescription">Примечания</label>
                                    <input type="text" class="form-control" placeholder="" id="addDeliveryDescription"  autocomplete="off">
                                </div>
                            </div>
                        </div>
                        <script type="text/javascript">
                            document.querySelector("#packDateInput").valueAsDate = new Date();
                        </script>
                        <!-- Insert rows -->
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" onclick="sendRequestToCreateDeleviryOak()">Отправить</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Send oak list for transportation end  MODAL -->

    <!--    Delivery-->
    <div class="modal fade" id="sendOakPackModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="sendOakPackageHeader"></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <!--       TUT         -->
                <form th:action="@{'/fabric/addPackToExistDeliveryDoc-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">
                        <div class="form-group">
                            <input type="number" class="form-control" id="selectedOakPackModalId" hidden="hidden" autocomplete="off" name="packId">

                            <label class="col-form-label" for="selectOakTruck">Машина</label>
                            <input type="text" class="form-control" list="trucksOakList" id="selectOakTruck" required="required" autocomplete="off" name="driverId">
                            <datalist id="trucksOakList">
                                    <option th:each="b : ${deliveryList}"  th:value="${b.id}" th:label="${b.driverInfo.idOfTruck}">
                            </datalist>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button submit" class="btn btn-primary">Добавить</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        function addPackageIntoOakDelivery(btnObj) {
            var trObj = btnObj.parentElement.parentElement;
            var trId =  $(trObj).find('td:eq(0)').attr('id');
            $('#selectedOakPackModalId').val(trId);
            console.log(  $(trObj).attr('id'));
            var codeOfSelectedPackage = $(trObj).find('th:eq(0)').text();

            $('#sendOakPackageHeader').text("Добавить пачку "+codeOfSelectedPackage+" к существующей доставке");

            $('#sendOakPackModal').modal('show');
        }
    </script>
    <!--    Delivery end-->

    <!--  Modal unform confirmation  -->
    <div class="modal fade" id="unformOakPackModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Расформирование пачек</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <!--       TUT         -->
                <form th:action="@{'/fabric/unformPackagedProduct-'+${userId}+'-'+${breedId}}" method="post">
                    <div class="modal-body">
                        <!--       TUT                 -->

                        <div class="form-group">
                            <input type="text" class="form-control" id="unformOakPackModalId" hidden="hidden" autocomplete="off" name="id">

                            <p id="unformOakPackModalConfirmation">
                                Вы уверены, что хотите расформировать пачку ?
                            </p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button submit" class="btn btn-primary">Расформировать</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function packageOakUnform(btnObj) {
            var trObj = btnObj.parentElement.parentElement;
            var trId =  $(trObj).find('td:eq(0)').attr('id');
            $('#unformOakPackModalId').val(trId);
            console.log( trId);
            var codeOfPackage = $(trObj).find('th:eq(0)').text();

            $('#unformOakPackModalConfirmation').text("Вы уверены, что хотите расформировать пачку "+codeOfPackage+" ?");
            $('#unformOakPackModal').modal('show');
        }
    </script>
    <!--  Modal confirmation  -->


    <script type="text/javascript">
        // listener for opening and closing
        $('#transportationtable tbody').on('click', 'td.details-control', function () {
            var tr = $(this).closest('tr');
            var row = table.row( tr );

            if ( row.child.isShown() ) {
                // already open
                row.child.hide();
                tr.removeClass('shown');
            }
            else {
                // open row
                row.child( format(row.data()) ).show();
                tr.addClass('shown');
            }
        } );



        $('#packageOakTableId tbody').on( 'click', 'button', function () {
            var trObj = this.parentElement.parentElement;
            var trId =  $(trObj).attr('id');
            $('#unformOakPackModalId').val(trId);
            console.log(  $(trObj).attr('id'));
            var codeOfPackage = $(trObj).find('th:eq(0)').text();

            $('#unformOakPackModalConfirmation').text("Вы уверены, что хотите расформировать пачку "+codeOfPackage+" ?");
            $('#unformOakPackModal').modal('show');
        } );


        function createOakPackageForm() {
            var arrOfTr = document.getElementById("listOfOakPackagesId").getElementsByTagName("tr");
            console.log("arr length = "+arrOfTr.length);
            var packNumber1 =   $("#sendForPackageModalCodeOak").val();
            var quality1 =      $("#sendForPackageModalQualityOak").val();
            var size1 =         $("#sendForPackageModalSizeOak").val();
            var length1 =       $("#sendForPackageModalLengthOak").val();

            var breedID = $("#breedID").val();
            var userID = $("#userID").val();

            var arrOfDesk = [];

            var tableBody = document.getElementById('listOfOakPackagesId');
            var listTr = tableBody.getElementsByTagName('tr');
            //fix one dimension array on controller
            arrOfDesk[0] = [];
            arrOfDesk[0][0] = "test";
            arrOfDesk[0][1] = "test";

            for (let i = 1; i <= listTr.length; i++) {
                let width = $(listTr[i - 1]).find('td:eq(0)').text();
                let count = $(listTr[i - 1]).find('td:eq(1)').text();

                arrOfDesk[i] = [];
                arrOfDesk[i][0] = width;
                arrOfDesk[i][1] = count;
            }

            if (arrOfDesk[1][0]!="No data available in table" && packNumber1 != "" && quality1 != "" && size1 != "" && length1 != ""){

                $.ajax({
                    method: "post",
                    url: "/createPackageOakObject-"+userID+"-"+breedID,
                    contextType: "application/json",
                    data: {
                        arrayOfDesk: arrOfDesk,
                        codeOfPackage: packNumber1,
                        quality: quality1,
                        sizeOfHeight: size1,
                        length: length1,
                    },
                    traditional: true,
                    success: function () {
                        location.reload();
                    },
                    error: function () {
                        alert("Error");
                    }
                })
            ;} else {
                alert("Заполните все поля!");
            }

        }


        function sendRequestToCreateDeleviryOak() {
            var arrOfTr = document.getElementsByClassName("selectMainTrPackage");
            console.log("arr length = "+arrOfTr.length);
            var idOfTruck1 = $("#addIdOfTruck").val();
            var name1 = $("#driverCredentionals").val();
            var phone1 = $("#driverPhone").val();
            var numberOfTruck1 = $("#numberOfTruck").val();
            var numberOfTrailer1 = $("#numberOfTrailer").val();
            var date1 = $("#packDateInput").val();
            var time1 = $("#packTimeInput").val();
            var contractName1 = $("#packContractId-hidden").val();
            var deliveryDestination1 = $("#packDeliveryDestination").val();
            var description1 = $("#addDeliveryDescription").val();
            var breedID = $("#breedID").val();
            var userID = $("#userID").val();


            var arrayOfId = [];

            for (var i = 0; i<arrOfTr.length;i++){
                var td = arrOfTr[i].getElementsByClassName("details-control")[0];
                arrayOfId[i] = td.getAttribute("id").replace('modal','');
                console.log(arrayOfId[i]);
            }

            if (arrayOfId[0]!="No data available in table" && idOfTruck1 != "" && name1 != "" && phone1 != "" && numberOfTruck1 != "" && numberOfTrailer1 != "" && date1 != "" && time1 != "" && contractName1 != "" && deliveryDestination1!="" && description1!=""){

                $.ajax({
                    method: "post",
                    url: "/createDeliveryDoc-"+userID+"-"+breedID,
                    contextType: "application/json",
                    data: {
                        list: arrayOfId,
                        name: name1,
                        phone: phone1,
                        idOfTruck: idOfTruck1,
                        numberOfTruck: numberOfTruck1,
                        numberOfTrailer: numberOfTrailer1,
                        dateOfUnloading: date1,
                        timeOfUnloading: time1,
                        contractName: contractName1,
                        deliveryDestination: deliveryDestination1,
                        description: description1
                    },
                    traditional: true,
                    success: function () {
                        location.reload();
                    },
                    error: function () {
                        alert("Error");
                    }
                });}
            else {
                alert("Заполните все поля!");
            }
         }
    </script>


</th:block>
